var fs = require("fs");
const request = require("request");
const cheerio = require("cheerio");
const puppeteer = require("puppeteer");

async function scraping(url) {
  // try {
  const browser = await puppeteer.launch({
    headless: true,
    // devtools: true,
  });
  const page = await browser.newPage();
  let imagelink = [];
  try {
    // page.on("console", (consoleObj) => console.log(consoleObj.text()));

    await page.goto(url);

    console.log("current link : ", url);
    imagelink = await page.evaluate(
      "[...document.querySelectorAll('#wn .tcase>a')].map(a => a.getAttribute('href'))"
    );
    // imagelink = await page.evaluate(() => {
    //   [...document.querySelectorAll("#wn .tcase>a")].map((a) => {
    //     var test = "";
    //     if (a.textContent.toLowerCase() == "wikimedia") {
    //       test = a.getAttribute("href");
    //     }
    //     return test;
    //   });
    // });
  } catch (error) {
    console.log(error);
  } finally {
    await browser.close();
  }
  return imagelink;
}

async function main() {
  var result = [];
  var url = [
    "https://free-images.com/display/statue_detail_lincoln_memorial.html",
    "https://free-images.com/display/statue_god_slovenia_work.html",
    "https://free-images.com/display/steeple_196281.html",
    "https://free-images.com/display/stockton_california_so_called_2.html",
    "https://free-images.com/display/strassenbahn_woltersdorf_tram_auf.html",
    "https://free-images.com/display/sultan_muhammad_004.html",
    "https://free-images.com/display/sun_in_fog.html",
    "https://free-images.com/display/sunny_isles_beach_skyline.html",
    "https://free-images.com/display/sunrise_in_steel_mill_0.html",
    "https://free-images.com/display/sunrise_views_from_summit_13.html",
    "https://free-images.com/display/sunrise_views_from_summit_41.html",
    "https://free-images.com/display/sunrise_views_from_summit_57.html",
    "https://free-images.com/display/sunset_1889_paul_signac.html",
    "https://free-images.com/display/sunset_across_ryogoku_bridge.html",
    "https://free-images.com/display/sunset_along_floral_embankment.html",
    "https://free-images.com/display/sunset_at_huntington_beach_1.html",
    "https://free-images.com/display/sunset_behind_windmill_nara_0.html",
    "https://free-images.com/display/sunset_by_charles_roussel.html",
    "https://free-images.com/display/sunset_comes_to_point_0.html",
    "https://free-images.com/display/sunset_landings_aboard_uss.html",
    "https://free-images.com/display/sunset_landscape_with_birds.html",
    "https://free-images.com/display/sunset_nara_549847.html",
    "https://free-images.com/display/sunset_on_leslie_salt_1.html",
    "https://free-images.com/display/sunset_on_little_sur_2.html",
    "https://free-images.com/display/sunset_over_rail_yards_0.html",
    "https://free-images.com/display/sunset_over_railyards_nara_0.html",
    "https://free-images.com/display/sunset_over_windmill_in_0.html",
    "https://free-images.com/display/sunset_seen_from_arctic.html",
    "https://free-images.com/display/sunset_seen_through_heavy_1.html",
    "https://free-images.com/display/sunset_smoke_nara_544688_0.html",
    "https://free-images.com/display/sunset_smoke_nara_544696_0.html",
    "https://free-images.com/display/suzuki_harunobu_evening_snow.html",
    "https://free-images.com/display/sv_ursula_s_plascem.html",
    "https://free-images.com/display/swan_on_lake_bled.html",
    "https://free-images.com/display/switzerland_l_c3_b6tschental.html",
    "https://free-images.com/display/tadpoles_338628.html",
    "https://free-images.com/display/take_odbornike_hocem_takih.html",
    "https://free-images.com/display/tamati_waka_nene_by.html",
    "https://free-images.com/display/technology_drive_nature_1342717.html",
    "https://free-images.com/display/television_antennas_at_sunset_2.html",
    "https://free-images.com/display/television_antennas_at_sunset_4.html",
    "https://free-images.com/display/temple_taiwan_taoism_clairvoyance.html",
    "https://free-images.com/display/tenno_jimmu.html",
    "https://free-images.com/display/thailand_buddhists_monks_453388.html",
    "https://free-images.com/display/that_accounts_for_it.html",
    "https://free-images.com/display/the_beach_at_villerville.html",
    "https://free-images.com/display/the_cottage_door_detail.html",
    "https://free-images.com/display/the_galactic_center.html",
    "https://free-images.com/display/the_house_seasons_built.html",
    "https://free-images.com/display/the_hunt_unicorn_tapestry.html",
    "https://free-images.com/display/the_london_eye_from.html",
    "https://free-images.com/display/the_love_lesson_antoine.html",
    "https://free-images.com/display/the_scream_pastel.html",
    "https://free-images.com/display/the_waterfront_at_sunset_4.html",
    "https://free-images.com/display/theth_church_albania_catholic.html",
    "https://free-images.com/display/thisle_verulamium_park_20050514.html",
    "https://free-images.com/display/thomas_leonidas_crittenden_brady.html",
    "https://free-images.com/display/thure_de_thulstrup_l.html",
    "https://free-images.com/display/tiepolo_vercellae.html",
    "https://free-images.com/display/tiger_berlin_1.html",
    "https://free-images.com/display/tiger_jpeg.html",
    "https://free-images.com/display/tn_sunrise_ship_2015.html",
    "https://free-images.com/display/tour_eiffel_p14.html",
    "https://free-images.com/display/tour_eiffel_pic02.html",
    "https://free-images.com/display/tour_eiffel_pic06.html",
    "https://free-images.com/display/tour_eiffel_seen_from.html",
    "https://free-images.com/display/tower_bridge_sunset_december.html",
    "https://free-images.com/display/tower_pe_c3_b1erudes.html",
    "https://free-images.com/display/tracy_arm_alaska_glacier.html",
    "https://free-images.com/display/train_jungle_train_mountain.html",
    "https://free-images.com/display/tree_avenue_spring_alley.html",
    "https://free-images.com/display/trichechus_manatus_latirostris_florida.html",
    "https://free-images.com/display/tricity_landscape_park.html",
    "https://free-images.com/display/trout_cutthroat_fish_oncorhynchus.html",
    "https://free-images.com/display/trout_lily_plant_erythronium.html",
    "https://free-images.com/display/truss_home_town_hall.html",
    "https://free-images.com/display/tule_elk_bulls_close.html",
    "https://free-images.com/display/tv_antennas_at_sunset_2.html",
    "https://free-images.com/display/twelve_spot_skimmer_dragonfly.html",
    "https://free-images.com/display/two_brown_bears_standing.html",
    "https://free-images.com/display/two_scenes_from_der.html",
    "https://free-images.com/display/under_elevated_railway_chicago.html",
    "https://free-images.com/display/unicorn_tapestry_unicorn_leaps.html",
    "https://free-images.com/display/university_zurich_eth_switzerland.html",
    "https://free-images.com/display/uss_stennis_during_hawaiian.html",
    "https://free-images.com/display/vanellus_macropterus.html",
    "https://free-images.com/display/various_types_surinamese_wdl2897.html",
    "https://free-images.com/display/veduta_kopra_1867.html",
    "https://free-images.com/display/venus_adonis_by_titian.html",
    "https://free-images.com/display/verganglichkeitsbuch_238_114v_totentanz.html",
    "https://free-images.com/display/vierbergelauf_sonnenaufgang_am_ulrichsbe_0.html",
    "https://free-images.com/display/view_focusing_on_narrow.html",
    "https://free-images.com/display/vineyard_field.html",
    "https://free-images.com/display/vintage_synthesizer_crumar_1601938.html",
    "https://free-images.com/display/vintage_synthesizer_crumar_1601941.html",
    "https://free-images.com/display/vintage_synthesizer_crumar_1601942.html",
    "https://free-images.com/display/vintage_synthesizer_emu_emulator.html",
    "https://free-images.com/display/volta_presbiteri_abril.html",
    "https://free-images.com/display/vue_panoramique_de_lexposition_3.html",
    "https://free-images.com/display/waiting_for_relief_checks.html",
    "https://free-images.com/display/walker_evans_shoeshine_stand.html",
    "https://free-images.com/display/walrus_animal_male_portrait.html",
    "https://free-images.com/display/walrus_cow_with_her.html",
    "https://free-images.com/display/walrus_herd_odobenus_rosmarus.html",
    "https://free-images.com/display/welt_galleria_t051.html",
    "https://free-images.com/display/wenceslas_hollar_abbot_purefoy.html",
    "https://free-images.com/display/white_trillium_virginia_bluebells.html",
    "https://free-images.com/display/wild_puma_panther.html",
    "https://free-images.com/display/william_adolphe_bouguereau_1825_128.html",
    "https://free-images.com/display/william_adolphe_bouguereau_1825_49.html",
    "https://free-images.com/display/william_brattle_house_00006a.html",
    "https://free-images.com/display/william_brattle_house_080178pu.html",
    "https://free-images.com/display/william_brattle_house_080180pu.html",
    "https://free-images.com/display/william_brattle_house_080183pu.html",
    "https://free-images.com/display/william_lawrence_house_bellefontaine_0.html",
    "https://free-images.com/display/william_lawrence_house_bellefontaine_2.html",
    "https://free-images.com/display/win_football.html",
    "https://free-images.com/display/windmill_in_sunset_at_0.html",
    "https://free-images.com/display/winslow_homer_schooner_at_0.html",
    "https://free-images.com/display/winter_snow_spruce_tree.html",
    "https://free-images.com/display/wla_metmuseum_unicorn_is.html",
    "https://free-images.com/display/woodland_path.html",
    "https://free-images.com/display/workers_on_day_shift.html",
    "https://free-images.com/display/wormwood_spring_medicinal_herbs.html",
    "https://free-images.com/display/yellow_mongoose_1.html",
    "https://free-images.com/display/young_cheetahs.html",
    "https://free-images.com/display/zdravica_st4_rokopis1.html",
    "https://free-images.com/display/keys_piano_sh.html",
    "https://free-images.com/display/kim_rice_vegetables_rolled.html",
    "https://free-images.com/display/king_eiders.html",
    "https://free-images.com/display/kingfisher_bird_aviary_color.html",
    "https://free-images.com/display/kitlv_28763_kurkdjian_ohannes.html",
    "https://free-images.com/display/kniphofia_cloppenburg_de_p6244250.html",
    "https://free-images.com/display/knotengitterzaun.html",
    "https://free-images.com/display/korea_chunnam_boo_geogeumdo.html",
    "https://free-images.com/display/krainska_deschela_1778.html",
    "https://free-images.com/display/la_3260_sunset_2010jan11.html",
    "https://free-images.com/display/la_adoracion_de_los_2.html",
    "https://free-images.com/display/la_lecture_de_la_2.html",
    "https://free-images.com/display/la_menaggie_djerri_siez_109.html",
    "https://free-images.com/display/la_menaggie_djerri_siez_123.html",
    "https://free-images.com/display/la_menaggie_djerri_siez_139.html",
    "https://free-images.com/display/la_menaggie_djerri_siez_173.html",
    "https://free-images.com/display/la_rendicion_de_bailen.html",
    "https://free-images.com/display/la_virgen_de_los_0.html",
    "https://free-images.com/display/laboratory_medical_lab_diagnostics_1.html",
    "https://free-images.com/display/lake_erie_at_sunset_3.html",
    "https://free-images.com/display/lampe_an_einer_historischen.html",
    "https://free-images.com/display/landscape_at_vogelenzang.html",
    "https://free-images.com/display/landscape_by_jervis_mcentee.html",
    "https://free-images.com/display/landscape_polling_bavaria_by.html",
    "https://free-images.com/display/largemouth_bass_caught_on.html",
    "https://free-images.com/display/lastenia_tello_de_michelena_0.html",
    "https://free-images.com/display/le_baiser_de_judas.html",
    "https://free-images.com/display/le_jeune_gaston_dit.html",
    "https://free-images.com/display/leaf_green_branch_back.html",
    "https://free-images.com/display/lemon_basil_hairy_natural.html",
    "https://free-images.com/display/leonardo_da_vinci_vergine_0.html",
    "https://free-images.com/display/leonardo_da_vinci_virgin_6.html",
    "https://free-images.com/display/les_cordeliers_episode_du_0.html",
    "https://free-images.com/display/lewis_midday_meal.html",
    "https://free-images.com/display/lilac_ornamental_shrub_flowers.html",
    "https://free-images.com/display/lilium_superbum_fws_1.html",
    "https://free-images.com/display/lincoln_o_21_by.html",
    "https://free-images.com/display/lion_in_masai_mara.html",
    "https://free-images.com/display/liptov_field_mountain_sun.html",
    "https://free-images.com/display/ljubljana_alley_homes_leave.html",
    "https://free-images.com/display/london_underground_1967_stock.html",
    "https://free-images.com/display/london_underground_1967_stock_0.html",
    "https://free-images.com/display/london_underground_1967_stock_1.html",
    "https://free-images.com/display/longear_sunfish_lepomis_megalotis.html",
    "https://free-images.com/display/longtail_salamander_eurycea_longicauda.html",
    "https://free-images.com/display/looking_up_into_silhouetted.html",
    "https://free-images.com/display/louis_dorleans_montrant_sa.html",
    "https://free-images.com/display/lower_manhattan_seen_from.html",
    "https://free-images.com/display/lower_manhattan_seen_from_0.html",
    "https://free-images.com/display/luca_signorelli_portrait_an.html",
    "https://free-images.com/display/m3_stuart_australia_1.html",
    "https://free-images.com/display/macro_cactus.html",
    "https://free-images.com/display/macro_photography_tharny_flower.html",
    "https://free-images.com/display/madonna_di_montecastello_tignale_1.html",
    "https://free-images.com/display/madrazo_viriatus_highres.html",
    "https://free-images.com/display/magnificent_sunset_over_water.html",
    "https://free-images.com/display/maison_des_jeunes_detenus.html",
    "https://free-images.com/display/maize_corn.html",
    "https://free-images.com/display/malaclemys_terrapin_diamondback_terrapin.html",
    "https://free-images.com/display/man_gym_muscle_fitness.html",
    "https://free-images.com/display/man_writing_letter_by.html",
    "https://free-images.com/display/manada.html",
    "https://free-images.com/display/manuel_dominguez_sanchez_el.html",
    "https://free-images.com/display/manzanar_relocation_center_manzanar_662.html",
    "https://free-images.com/display/maria_cristina_de_borbon_0.html",
    "https://free-images.com/display/maria_fortuny_african_beach.html",
    "https://free-images.com/display/marie_stuart_reine_decosse.html",
    "https://free-images.com/display/marriage_la_mode_4_0.html",
    "https://free-images.com/display/masaimaracheetahs01.html",
    "https://free-images.com/display/mather_point_grand_canyon.html",
    "https://free-images.com/display/medieval_village_jura_france.html",
    "https://free-images.com/display/men_standing_at_top.html",
    "https://free-images.com/display/merriams_turkey_meleagris_gallopavo.html",
    "https://free-images.com/display/metro_serie_5600_beurs.html",
    "https://free-images.com/display/michel_richard_delalande_engraving.html",
    "https://free-images.com/display/micrastur_mirandollei_1902.html",
    "https://free-images.com/display/micrastur_semitorquatus_1902.html",
    "https://free-images.com/display/middletown_friends_school.html",
    "https://free-images.com/display/milkwer_flower_buds_macro.html",
    "https://free-images.com/display/mineral_kyushu_imo_9346366_1.html",
    "https://free-images.com/display/mir_musavvir_002.html",
    "https://free-images.com/display/model_airplanes_union_station.html",
    "https://free-images.com/display/mongoosecotswoldwildlifepark.html",
    "https://free-images.com/display/monkey_selfie_with_stroopwafel.html",
    "https://free-images.com/display/monks_praying.html",
    "https://free-images.com/display/montague_shearman_vanity_fair.html",
    "https://free-images.com/display/morning_dawn_sunrise_sky.html",
    "https://free-images.com/display/morning_sunrise_1.html",
    "https://free-images.com/display/moth_nature_slovenia_butterfly.html",
    "https://free-images.com/display/mountains_snow_march_interregio.html",
    "https://free-images.com/display/msc_texas_imo_9286243_10.html",
    "https://free-images.com/display/msc_texas_imo_9286243_4.html",
    "https://free-images.com/display/msc_texas_imo_9286243_5.html",
    "https://free-images.com/display/much_tattooed_sailor_aboard_1.html",
    "https://free-images.com/display/muhammad_yusuf_young_1640.html",
    "https://free-images.com/display/mule_deer_standing_on.html",
    "https://free-images.com/display/music_amplifier_sound_equipment.html",
    "https://free-images.com/display/music_room_detail_schloss.html",
    "https://free-images.com/display/n_c3_b6rvenich_airport.html",
    "https://free-images.com/display/near_coolidge_arizona_white_1.html",
    "https://free-images.com/display/newton_lplane_mandelbrot_smooth.html",
    "https://free-images.com/display/night_train_train_level.html",
    "https://free-images.com/display/night_view_downtown_section.html",
    "https://free-images.com/display/nishime_soccer_ground_4.html",
    "https://free-images.com/display/no_known_restrictions_ball.html",
    "https://free-images.com/display/north_head_lighthouse_summer.html",
    "https://free-images.com/display/notre_dame_cathedral_paris_17.html",
    "https://free-images.com/display/nouvel_ambigu_betail_humain.html",
    "https://free-images.com/display/novices_buddhist_work_wat.html",
    "https://free-images.com/display/nyc_liberty_6.html",
    "https://free-images.com/display/nyc_mulberry_street_3g04637u.html",
    "https://free-images.com/display/nystalus_chacuru_chacuru_1841.html",
    "https://free-images.com/display/october_sunset_dwight_w.html",
    "https://free-images.com/display/octopus_at_kelly_tarltons.html",
    "https://free-images.com/display/odontophorus_leucolaemuscj_avesp74a.html",
    "https://free-images.com/display/odontophorus_melanotis_1902.html",
    "https://free-images.com/display/old_houses_street_city.html",
    "https://free-images.com/display/old_transpot_ship_on.html",
    "https://free-images.com/display/on_highway_84_outskirts_0.html",
    "https://free-images.com/display/one_wine_cellers_or_0.html",
    "https://free-images.com/display/operation_strangle_b_26.html",
    "https://free-images.com/display/oppression_women_violence_barbie.html",
    "https://free-images.com/display/orange_marigold_clarkson.html",
    "https://free-images.com/display/orthoporus_spp_new_mexico.html",
    "https://free-images.com/display/otter_cute_animal_365370.html",
    "https://free-images.com/display/ottheinrich_folio288r_rev6a.html",
    "https://free-images.com/display/owl_bird_animal_nature.html",
    "https://free-images.com/display/pablo_national_wildlife_refuge.html",
    "https://free-images.com/display/pacific_walrus_bull_odobenus.html",
    "https://free-images.com/display/pacific_walrus_marine_mammals.html",
    "https://free-images.com/display/padlock_love_bridge_1547354.html",
    "https://free-images.com/display/padlock_love_bridge_memoty.html",
    "https://free-images.com/display/pahoeoe_fountain_edit3.html",
    "https://free-images.com/display/painted_lady_butterfly_vanessa_0.html",
    "https://free-images.com/display/pair_red_fox_pups.html",
    "https://free-images.com/display/panoramics_piran_2013_2.html",
    "https://free-images.com/display/paris_gay_pride_2013_18.html",
    "https://free-images.com/display/part_u_s_steel_0.html",
    "https://free-images.com/display/paul_cezanne_160.html",
    "https://free-images.com/display/pearl_hermes_atoll_islands.html",
    "https://free-images.com/display/people_walking_across_small.html",
    "https://free-images.com/display/persian_angel_1555.html",
    "https://free-images.com/display/persian_iran_empire_1747.html",
    "https://free-images.com/display/pharomachrus_pavoninus_1838.html",
    "https://free-images.com/display/philip_ii.html",
    "https://free-images.com/display/photograph_john_f_kennedys.html",
    "https://free-images.com/display/piano_unidentified_museo_nacional.html",
    "https://free-images.com/display/pieter_bruegel_elder_hunters_3.html",
    "https://free-images.com/display/pieter_brueghel_de_jonge_36.html",
    "https://free-images.com/display/pieter_brueghel_younger_or.html",
    "https://free-images.com/display/pima_county_arizona_mexican_0.html",
    "https://free-images.com/display/pink_flowers_common_milkweed.html",
    "https://free-images.com/display/pink_flowers_on_an.html",
    "https://free-images.com/display/piri_reis_world_map_1.html",
    "https://free-images.com/display/pismo_beach_california_02.html",
    "https://free-images.com/display/pismo_beach_california_06.html",
    "https://free-images.com/display/plakat_za_jadran.html",
    "https://free-images.com/display/plakat_za_zlatorog_1920_0.html",
    "https://free-images.com/display/plan_de_paris_vers_1.html",
    "https://free-images.com/display/plane_airbus_saudia_takeoff.html",
    "https://free-images.com/display/plane_embraer_190_ar.html",
    "https://free-images.com/display/platform_metro_s_bahn.html",
    "https://free-images.com/display/pokljuka_2013_4.html",
    "https://free-images.com/display/police_helicopter_bk_117.html",
    "https://free-images.com/display/pool_tables_surroundings_inside.html",
    "https://free-images.com/display/portrait_franc_williams_harold.html",
    "https://free-images.com/display/portrait_man_by_jan_2_2.html",
    "https://free-images.com/display/power_farming_displaces_tenants.html",
    "https://free-images.com/display/prefecture_de_police_de_18.html",
    "https://free-images.com/display/primoz_trubar_church_in_0.html",
    "https://free-images.com/display/procyon_lotor_raccoon.html",
    "https://free-images.com/display/profile_shot_san_joaquin.html",
    "https://free-images.com/display/prokudin_gorskii_09.html",
  ];

  for (var i = 0; i < url.length; i++) {
    var scrapingImg = await scraping(url[i]);
    if (scrapingImg == false) {
      console.log(`\x1b[31m\x1b[43m Error : ${url}  \x1b[0m`);
    }
    result = [...result, ...scrapingImg];
    // result = [...result, ...scrapingImg];

    console.log("complete ...... : " + result.length);
    await new Promise((resolve) => setTimeout(resolve, 1000));
  }
  console.log(`All result : ${result.length}`);
  const getNotDup = result.filter(
    (value, index, self) => self.indexOf(value) === index
  );
  console.log(`Unique result : ${getNotDup.length}`);
  // var json = JSON.stringify(getNotDup);
  var json = JSON.stringify(result);
  // console.log(json);
  fs.writeFile("data/wiki/new-free-image-01.json", json, function (err) {
    if (err) {
      return console.log(err);
    }

    console.log("The file was saved!");
    return true;
  });
}

main();
