var fs = require("fs");
const request = require("request");
const cheerio = require("cheerio");
const puppeteer = require("puppeteer");

async function scraping(url) {
  // try {
  const browser = await puppeteer.launch({
    headless: true,
    // devtools: true,
  });
  const page = await browser.newPage();
  let imagelink = [];
  try {
    // page.on("console", (consoleObj) => console.log(consoleObj.text()));

    await page.goto(url);

    console.log("current link : ", url);
    imagelink = await page.evaluate(
      "[...document.querySelectorAll('#wn .tcase>a')].map(a => a.getAttribute('href'))"
    );
    // imagelink = await page.evaluate(() => {
    //   [...document.querySelectorAll("#wn .tcase>a")].map((a) => {
    //     var test = "";
    //     if (a.textContent.toLowerCase() == "wikimedia") {
    //       test = a.getAttribute("href");
    //     }
    //     return test;
    //   });
    // });
  } catch (error) {
    console.log(error);
  } finally {
    await browser.close();
  }
  return imagelink;
}

async function main() {
  var result = [];
  var url = [
    "https://free-images.com/display/pseudo_seneca_bm_gr1962.html",
    "https://free-images.com/display/puerto_rican_boa_snake.html",
    "https://free-images.com/display/purple_phacelia_flower.html",
    "https://free-images.com/display/qatar_airways_cargo_boeing.html",
    "https://free-images.com/display/raden_saleh_hunt.html",
    "https://free-images.com/display/railway_gleise_seemed_713616.html",
    "https://free-images.com/display/rainbow_trout_fish_onchorhynchus.html",
    "https://free-images.com/display/ramadan_sigaretten_blik_pic2.html",
    "https://free-images.com/display/rame_reversible_regionale_strasbourg.html",
    "https://free-images.com/display/ramphotrigon_megacephalum_1841.html",
    "https://free-images.com/display/razglednica_kranja.html",
    "https://free-images.com/display/red_admiral_butterfly_vanessa.html",
    "https://free-images.com/display/red_panda_16738586833.html",
    "https://free-images.com/display/red_panda_24426785663.html",
    "https://free-images.com/display/red_panda_24426894943.html",
    "https://free-images.com/display/red_panda_24758298510.html",
    "https://free-images.com/display/red_wolf_running_canis.html",
    "https://free-images.com/display/reliefs_spreckels_temple_music.html",
    "https://free-images.com/display/research_vessel_big_ship.html",
    "https://free-images.com/display/restingfarmercrowley1938.html",
    "https://free-images.com/display/restoration_area_sign.html",
    "https://free-images.com/display/ret_5400_schiedam_interieur.html",
    "https://free-images.com/display/retrato_ecuestre_del_duque.html",
    "https://free-images.com/display/richard_m_nixon_ca.html",
    "https://free-images.com/display/richard_m_nixon_shaking.html",
    "https://free-images.com/display/richard_parkes_bonington_beach.html",
    "https://free-images.com/display/richard_wilson_italian_landscape.html",
    "https://free-images.com/display/rihard_jakopic_krizanke_svez.html",
    "https://free-images.com/display/robert_montgomery_1939_cropped.html",
    "https://free-images.com/display/robert_montgomery_1939_tif.html",
    "https://free-images.com/display/romania_bank_danube_1611969.html",
    "https://free-images.com/display/rose_garden_flower.html",
    "https://free-images.com/display/rose_pink_1.html",
    "https://free-images.com/display/roses_crosses_at_ossuaire.html",
    "https://free-images.com/display/roshi_ensei_lifting_heavy.html",
    "https://free-images.com/display/royal_conservatory_music_toronto.html",
    "https://free-images.com/display/rural_school_children_san.html",
    "https://free-images.com/display/rushmore_national_park_park.html",
    "https://free-images.com/display/russianisfahan.html",
    "https://free-images.com/display/s_bahnhof_birkenstein_3.html",
    "https://free-images.com/display/saint_martin_grandes_heures.html",
    "https://free-images.com/display/saint_michaels_castle_in.html",
    "https://free-images.com/display/sakata_kaidomaru_struggling_with.html",
    "https://free-images.com/display/samuel_bough_west_wemyss.html",
    "https://free-images.com/display/san_vito_lo_capo_0.html",
    "https://free-images.com/display/sanvitolocapo1.html",
    "https://free-images.com/display/sapho_jean_baptiste_regnault.html",
    "https://free-images.com/display/sapporo_art_museum.html",
    "https://free-images.com/display/scenic_geese_flying_at.html",
    "https://free-images.com/display/scenic_view_from_seward_0.html",
    "https://free-images.com/display/scenic_view_mount_shasta.html",
    "https://free-images.com/display/scenic_views_along_route.html",
    "https://free-images.com/display/schultz_berlin_1688.html",
    "https://free-images.com/display/sculptures_at_brihadeswara_temple.html",
    "https://free-images.com/display/segwun_wenonah_sit_out.html",
    "https://free-images.com/display/self_portrait_1908_or.html",
    "https://free-images.com/display/sennheiser_wireless_receivers_rack.html",
    "https://free-images.com/display/shahnama_met_1970_301_2.html",
    "https://free-images.com/display/shanghai_skyline_at_night.html",
    "https://free-images.com/display/ship_paddle_steamers_steamboat.html",
    "https://free-images.com/display/side_view_close_up.html",
    "https://free-images.com/display/sidney_hall_uranias_mirror_57.html",
    "https://free-images.com/display/sinokor_sunrise_imo_9602148_0.html",
    "https://free-images.com/display/slovenia_pass_mountains_565570.html",
    "https://free-images.com/display/smith_arch_john_b.html",
    "https://free-images.com/display/snow_leopard_in_moscow.html",
    "https://free-images.com/display/sotetkapu.html",
    "https://free-images.com/display/southern_blue_flag_iris_0.html",
    "https://free-images.com/display/southern_styria_wine_vine.html",
    "https://free-images.com/display/spicebush_swallowtail_butterfly_larva.html",
    "https://free-images.com/display/spiral_seashells_painted_gold.html",
    "https://free-images.com/display/sport_jump_long_jump.html",
    "https://free-images.com/display/springtime_winterthur_museum_dsc01629.html",
    "https://free-images.com/display/stadium_aviva_in_dublin.html",
    "https://free-images.com/display/standing_stones_stenness_062015.html",
    "https://free-images.com/display/stanley_kubrick_l_elevated.html",
    "https://free-images.com/display/station_train_railway_907937.html",
    "https://free-images.com/display/claude_monet_white_frost.html",
    "https://free-images.com/display/climbing_helmets_climbing_equipment.html",
    "https://free-images.com/display/close_up_head_young.html",
    "https://free-images.com/display/close_up_image_manatee.html",
    "https://free-images.com/display/close_up_profile_front.html",
    "https://free-images.com/display/close_up_shot_bull.html",
    "https://free-images.com/display/close_view_large_deer.html",
    "https://free-images.com/display/close_view_red_flowers.html",
    "https://free-images.com/display/close_view_yellow_flowers.html",
    "https://free-images.com/display/coenocorypha_aucklandica_hullmandel.html",
    "https://free-images.com/display/cognac_16_la_femme.html",
    "https://free-images.com/display/colored_pencils_felt_tip.html",
    "https://free-images.com/display/coltraneh.html",
    "https://free-images.com/display/columbus_taking_possession.html",
    "https://free-images.com/display/combat_love_chastity_gherardo.html",
    "https://free-images.com/display/comminge_by_claudius_jacquand_3.html",
    "https://free-images.com/display/common_housefly_musca_domestica_0.html",
    "https://free-images.com/display/computer_tapes.html",
    "https://free-images.com/display/concern_shield_tradition_168264.html",
    "https://free-images.com/display/concorde_1977.html",
    "https://free-images.com/display/concrete_mixing_plant_birmingham.html",
    "https://free-images.com/display/concrete_mixing_plant_birmingham_0.html",
    "https://free-images.com/display/condesa_de_chinchon.html",
    "https://free-images.com/display/confessional_oak_beichth_c3.html",
    "https://free-images.com/display/conifer_tree_in_park.html",
    "https://free-images.com/display/constitution_united_states_page_3.html",
    "https://free-images.com/display/copperhead_snake_head_reptile.html",
    "https://free-images.com/display/coracina_personata_pollens.html",
    "https://free-images.com/display/correggio_antonio_allegri_italian.html",
    "https://free-images.com/display/cortaro_farms_pinal_county_25.html",
    "https://free-images.com/display/cortaro_farms_pinal_county_28.html",
    "https://free-images.com/display/cortaro_farms_pinal_county_45.html",
    "https://free-images.com/display/crab_food_gourmet_788988.html",
    "https://free-images.com/display/cross_saved_beach_ring.html",
    "https://free-images.com/display/curtiss_c_76_at.html",
    "https://free-images.com/display/danae_shower_gold_adolf.html",
    "https://free-images.com/display/dandelion_with_seeds.html",
    "https://free-images.com/display/danxia_landform_yadan_zhangye.html",
    "https://free-images.com/display/dates_10_8_09.html",
    "https://free-images.com/display/dawns_early_light_struggles_0.html",
    "https://free-images.com/display/de_rutzen_vanity_fair.html",
    "https://free-images.com/display/del_taco_1_close.html",
    "https://free-images.com/display/delisle_lasie.html",
    "https://free-images.com/display/denzil_best_al_casey_0.html",
    "https://free-images.com/display/diamond_da40_sunrise.html",
    "https://free-images.com/display/diamond_terrapin_turtle_reptile.html",
    "https://free-images.com/display/diego_rodriguez_de_silva.html",
    "https://free-images.com/display/dig13620_273.html",
    "https://free-images.com/display/dodecatheon_meadia_shooting_star.html",
    "https://free-images.com/display/dog_jump_an_athlete.html",
    "https://free-images.com/display/dog_shakes_itself_funny.html",
    "https://free-images.com/display/dog_winth_hunters_hunting.html",
    "https://free-images.com/display/door_front_door_house.html",
    "https://free-images.com/display/dr_teofilo_carneiro_1.html",
    "https://free-images.com/display/dragon_myth_story_god.html",
    "https://free-images.com/display/dragon_myth_story_god_0.html",
    "https://free-images.com/display/dragonfly_insect_pairing_pond.html",
    "https://free-images.com/display/duchman_breeches_flower_dicentra.html",
    "https://free-images.com/display/ducks_winter_wildlife_outside.html",
    "https://free-images.com/display/duisburg_20160814_map_6829.html",
    "https://free-images.com/display/duisburg_20160820_map_7560.html",
    "https://free-images.com/display/dutch_ships_in_calm.html",
    "https://free-images.com/display/dynamiting_stump.html",
    "https://free-images.com/display/earl_desart_vanity_fair.html",
    "https://free-images.com/display/easter_painted_turtle_reptile.html",
    "https://free-images.com/display/eastern_tailed_blue_butterfly_0.html",
    "https://free-images.com/display/eaton_chapel_5.html",
    "https://free-images.com/display/echinacea_bee_echinacea_purpurea.html",
    "https://free-images.com/display/edmund_blair_leighton_accolade.html",
    "https://free-images.com/display/edo_1844_1848_map.html",
    "https://free-images.com/display/edouard_drumont_caricature_affaire.html",
    "https://free-images.com/display/eduard_gurk_blick_auf.html",
    "https://free-images.com/display/eduard_gurk_die_franzensburg_0.html",
    "https://free-images.com/display/edvard_munch_rosa_meissner.html",
    "https://free-images.com/display/edward_burne_jones_adoration.html",
    "https://free-images.com/display/edward_lear_near_tough.html",
    "https://free-images.com/display/eenhoorn_in_de_nieuwe.html",
    "https://free-images.com/display/ego_katedralis.html",
    "https://free-images.com/display/egon_schiele_022.html",
    "https://free-images.com/display/egon_schiele_lesbisches_liebespaar.html",
    "https://free-images.com/display/eiffel_tower_20051010.html",
    "https://free-images.com/display/eiffel_tower_day_sept.html",
    "https://free-images.com/display/eiffel_tower_looking_up.html",
    "https://free-images.com/display/eight_point_white_tailed.html",
    "https://free-images.com/display/el_greco_domenikos_theotokopoulos_2_2.html",
    "https://free-images.com/display/elektron_analog_four_left.html",
    "https://free-images.com/display/elephants_at_etosha_national_1.html",
    "https://free-images.com/display/elioth_gruner_frosty_sunrise.html",
    "https://free-images.com/display/elk_standing_in_grassy.html",
    "https://free-images.com/display/ella_fitzgerald_gottlieb_02871.html",
    "https://free-images.com/display/eloy_district_pinal_county_46.html",
    "https://free-images.com/display/eloy_district_pinal_county_75.html",
    "https://free-images.com/display/eloy_district_pinal_county_79.html",
    "https://free-images.com/display/eloy_district_pinal_county_84.html",
    "https://free-images.com/display/eloy_district_pinal_county_91.html",
    "https://free-images.com/display/eloy_pinal_county_arizona_79.html",
    "https://free-images.com/display/equipe_de_france_du.html",
    "https://free-images.com/display/erosion_control_efforts.html",
    "https://free-images.com/display/es_409_stoomtrein_dendermonde.html",
    "https://free-images.com/display/esherick_house_philly_b.html",
    "https://free-images.com/display/estacade_at_sunset.html",
    "https://free-images.com/display/etosha_parkea.html",
    "https://free-images.com/display/executive_suite_boardroom_epa.html",
    "https://free-images.com/display/extermination_evil_shinchu.html",
    "https://free-images.com/display/extermination_evil_tenkeisei.html",
    "https://free-images.com/display/extermination_evil_tenkeisei_crop.html",
    "https://free-images.com/display/fabert_abraham_de_bnf.html",
    "https://free-images.com/display/faith_cross_jesus_christian.html",
    "https://free-images.com/display/fall_foliage_in_hillside.html",
    "https://free-images.com/display/fallkniven_s1_png.html",
    "https://free-images.com/display/farm_security_administration_chief.html",
    "https://free-images.com/display/farmer_walking_in_dust.html",
    "https://free-images.com/display/ferryboat_water_lake_disney.html",
    "https://free-images.com/display/fighter_plane_aeroplane_950906.html",
    "https://free-images.com/display/file_bosch_hieronymus_garden.html",
    "https://free-images.com/display/file_infantryman_with_halftrack.html",
    "https://free-images.com/display/fire_pink_flower.html",
    "https://free-images.com/display/fire_tank_fire_truck_0.html",
    "https://free-images.com/display/fleurs_roses_de_printemps.html",
    "https://free-images.com/display/florin_california_farm_mother_0.html",
    "https://free-images.com/display/flower_rose_pink_red.html",
    "https://free-images.com/display/flying_on_motor_hang.html",
    "https://free-images.com/display/fr_2810_tav_59v.html",
    "https://free-images.com/display/fra_angelico_adoration.html",
    "https://free-images.com/display/france_1727_g_half_1.html",
    "https://free-images.com/display/france_1791_30_sols.html",
    "https://free-images.com/display/france_1792_half_ecu.html",
    "https://free-images.com/display/francesco_hayez_008.html",
    "https://free-images.com/display/francis_towne_on_dee.html",
    "https://free-images.com/display/francisco_jose_de_goya_3.html",
    "https://free-images.com/display/francois_clouet_diane_de.html",
    "https://free-images.com/display/francois_ier_montre_a_0.html",
    "https://free-images.com/display/frank_d_walker_building_4.html",
    "https://free-images.com/display/freight_depot_us_army.html",
    "https://free-images.com/display/frontal_view_male_moose.html",
    "https://free-images.com/display/g_dury_portrait_dom.html",
    "https://free-images.com/display/gavin_hamilton_coriolanus_act_2.html",
    "https://free-images.com/display/gentile_da_fabriano_adorazione.html",
    "https://free-images.com/display/george_pitt_lewis_vanity_0.html",
    "https://free-images.com/display/gericaulthorseman.html",
    "https://free-images.com/display/gerladton_wax_flowers_bloom.html",
    "https://free-images.com/display/gfp_road_by_neighborhood.html",
    "https://free-images.com/display/gfp_texas_big_bend_41.html",
    "https://free-images.com/display/gfp_wisconsin_madison_sea.html",
    "https://free-images.com/display/gfp_wisconsin_military_ridge_0.html",
    "https://free-images.com/display/ghana_fischer_water_673065.html",
    "https://free-images.com/display/ghyas_el_din_jami.html",
    "https://free-images.com/display/giant_tausendf_c3_bc.html",
    "https://free-images.com/display/giant_tausendf_c3_bc_1.html",
    "https://free-images.com/display/girl_workers_in_booming.html",
    "https://free-images.com/display/glaucidium_minutissimum_1838.html",
    "https://free-images.com/display/glean_8855.html",
    "https://free-images.com/display/gleise_railway_narrow_gauge.html",
    "https://free-images.com/display/goldenseal_plant_hydrastis_canadensis.html",
    "https://free-images.com/display/goldenunicorn.html",
    "https://free-images.com/display/golf_course_half_moon.html",
    "https://free-images.com/display/gorilla_port_lympne1.html",
    "https://free-images.com/display/gotavallen.html",
    "https://free-images.com/display/gottlieb_planck_01.html",
    "https://free-images.com/display/goya_maja_naga2.html",
    "https://free-images.com/display/goya_maja_ubrana2.html",
    "https://free-images.com/display/grapes_vitis_vinifera.html",
    "https://free-images.com/display/gray_goldenrod_solidago_nemoralis.html",
    "https://free-images.com/display/great_springled_fritillary_on.html",
    "https://free-images.com/display/griffon_vulture_at_gamla_0.html",
    "https://free-images.com/display/group_sea_otters_enhydra.html",
    "https://free-images.com/display/group_steller_sea_lions.html",
    "https://free-images.com/display/group_walruses_odobenus_rosmarus.html",
    "https://free-images.com/display/guilin_mifan.html",
    "https://free-images.com/display/hagia_sophia_laengsschnitt.html",
    "https://free-images.com/display/hamilton_beer_revenue_stamp.html",
    "https://free-images.com/display/hand_444159_640.html",
    "https://free-images.com/display/hannibal_slodtz_louvre_mr2093.html",
    "https://free-images.com/display/hapalopsittaca_amazonina_1849.html",
    "https://free-images.com/display/hapalopsittaca_melanotis_1849.html",
    "https://free-images.com/display/harbor_seal_on_patch.html",
    "https://free-images.com/display/harbour_port_water_mediterranean.html",
    "https://free-images.com/display/harvey_m_vaile_mansion.html",
    "https://free-images.com/display/harvey_m_vaile_mansion_0.html",
    "https://free-images.com/display/harvey_m_vaile_mansion_1.html",
    "https://free-images.com/display/harvey_m_vaile_mansion_10.html",
    "https://free-images.com/display/harvey_m_vaile_mansion_2.html",
    "https://free-images.com/display/helen_dinsmore_huntingdon.html",
    "https://free-images.com/display/henri_de_toulouse_lautrec_123.html",
    "https://free-images.com/display/henri_fantin_latour_roses_3.html",
    "https://free-images.com/display/herd_walrus_marine_mammals.html",
    "https://free-images.com/display/herman_chittison_october_1946.html",
    "https://free-images.com/display/heures_ch_dangouleme_saint.html",
    "https://free-images.com/display/hieronymus_bosch_christ_mocked.html",
    "https://free-images.com/display/hippolyte_rossignol_vaccine_un.html",
    "https://free-images.com/display/hiroshige_sunset_hill_meguro.html",
    "https://free-images.com/display/homme_avec_barbe_portrait.html",
    "https://free-images.com/display/honolulu_harbor.html",
    "https://free-images.com/display/horse_mastiff_car_654966.html",
    "https://free-images.com/display/horses_team_white_72442.html",
    "https://free-images.com/display/horst_hacker_schmiede_im.html",
    "https://free-images.com/display/hugo_van_der_goes_77.html",
    "https://free-images.com/display/hylophilus_thoracicus_1838.html",
    "https://free-images.com/display/hyundai_manufacturing_plant_montgomery.html",
    "https://free-images.com/display/hyundais_first_assembly_manufacturing_1.html",
    "https://free-images.com/display/hyundais_first_assembly_manufacturing_3.html",
    "https://free-images.com/display/i_think_this_is.html",
    "https://free-images.com/display/img_38461.html",
    "https://free-images.com/display/img_5077.html",
    "https://free-images.com/display/incheon_soccer_stadium_2.html",
    "https://free-images.com/display/inez_mullholland_i_i.html",
    "https://free-images.com/display/inside_suite.html",
    "https://free-images.com/display/interferon.html",
    "https://free-images.com/display/interieur_mp05_ligne_1_0.html",
    "https://free-images.com/display/interieur_mp05_ligne_1_2.html",
    "https://free-images.com/display/interieur_mp05_ligne_1_4.html",
    "https://free-images.com/display/iron_lung_c_1933.html",
    "https://free-images.com/display/istanbul_pu889.html",
    "https://free-images.com/display/ivan_aivazovsky_disembarkation_christoph.html",
    "https://free-images.com/display/jacques_de_molay_grand.html",
    "https://free-images.com/display/james_lennox_hannay_vanity.html",
    "https://free-images.com/display/james_ward_cattle_at.html",
    "https://free-images.com/display/jan_van_eyck_diptych_15.html",
    "https://free-images.com/display/jan_van_eyck_diptych_16.html",
    "https://free-images.com/display/jan_van_eyck_diptych_17.html",
    "https://free-images.com/display/jan_van_eyck_diptych_4.html",
    "https://free-images.com/display/janez_potocnik_sv_marjeta.html",
    "https://free-images.com/display/japan_tattoo_1890s.html",
  ];

  for (var i = 0; i < url.length; i++) {
    var scrapingImg = await scraping(url[i]);
    if (scrapingImg == false) {
      console.log(`\x1b[31m\x1b[43m Error : ${url}  \x1b[0m`);
    }
    result = [...result, ...scrapingImg];
    // result = [...result, ...scrapingImg];

    console.log("complete ...... : " + result.length);
    await new Promise((resolve) => setTimeout(resolve, 1000));
  }
  console.log(`All result : ${result.length}`);
  const getNotDup = result.filter(
    (value, index, self) => self.indexOf(value) === index
  );
  console.log(`Unique result : ${getNotDup.length}`);
  // var json = JSON.stringify(getNotDup);
  var json = JSON.stringify(result);
  // console.log(json);
  fs.writeFile("data/wiki/new-free-image-02.json", json, function (err) {
    if (err) {
      return console.log(err);
    }

    console.log("The file was saved!");
    return true;
  });
}

main();
